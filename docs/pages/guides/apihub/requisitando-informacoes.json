{
  "path": "/docs/guides/apihub/requisitando-informacoes",
  "body": [
    "div",
    null,
    [
      "h2",
      {
        "id": "requisitos"
      },
      " ",
      [
        "a",
        {
          "href": "#requisitos"
        },
        "Requisitos"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Para que um app possa requisitar informações através de actions em uma determinada comunidade ele deve cumprir os seguintes requisitos:"
    ],
    " ",
    [
      "ul",
      null,
      " ",
      [
        "li",
        null,
        "Estar aprovado e instalado na comunidade cujas informações deseja requisitar"
      ],
      " ",
      [
        "li",
        null,
        "Ter a funcionalidade de feature ",
        [
          "code",
          null,
          "services"
        ],
        " habilitada "
      ],
      " ",
      [
        "li",
        null,
        "Ter todas as actions que deseja requisitar descritas no array ",
        [
          "code",
          null,
          "requests"
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Uma vez que o seu app está instalado e configurado, é possível requisitar informações seguindo o fluxo abaixo."
    ],
    " ",
    [
      "h2",
      {
        "id": "encontrar-provedores-para-uma-determinada-action"
      },
      " ",
      [
        "a",
        {
          "href": "#encontrar-provedores-para-uma-determinada-action"
        },
        "Encontrar provedores para uma determinada action"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "O primeiro passo de um app que tem permissão para requisitar uma determinada action é identificar quais são os possíveis provedores daquela informação na comunidade em que está instalado. Isso pode ser feito através da requisição mostrada abaixo: "
    ],
    " ",
    [
      "docs-code",
      {
        "language": "http"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token method"
            },
            [
              "span",
              {
                "class": "token get"
              },
              "GET"
            ]
          ],
          " ",
          [
            "span",
            {
              "class": "token path"
            },
            "/services/discover/",
            [
              "span",
              {
                "class": "token param"
              },
              "{action}"
            ]
          ],
          [
            "span",
            {
              "class": "token query"
            },
            [
              "span",
              {
                "class": "token separator"
              },
              "?"
            ],
            [
              "span",
              {
                "class": "token param"
              },
              [
                "span",
                {
                  "class": "token name"
                },
                "version"
              ],
              "=",
              [
                "span",
                {
                  "class": "token value"
                },
                [
                  "span",
                  {
                    "class": "token string"
                  },
                  "{versao}"
                ]
              ]
            ],
            [
              "span",
              {
                "class": "token separator"
              },
              "&"
            ],
            [
              "span",
              {
                "class": "token param"
              },
              [
                "span",
                {
                  "class": "token name"
                },
                "_community"
              ],
              "=",
              [
                "span",
                {
                  "class": "token value"
                },
                [
                  "span",
                  {
                    "class": "token string"
                  },
                  "{idComunidade}"
                ]
              ]
            ]
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "ul",
      null,
      " ",
      [
        "li",
        null,
        [
          "strong",
          null,
          "action"
        ],
        ": Identificador da notificação "
      ],
      " ",
      [
        "li",
        null,
        [
          "strong",
          null,
          "version"
        ],
        ": Versão do app"
      ],
      " ",
      [
        "li",
        null,
        [
          "strong",
          null,
          "_community"
        ],
        ": Identificador da comunidade"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Essa requisição retorna os provedores que podem responder a action especificada como parametro na rota mostrada acima no seeguinte formato:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "js"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token punctuation"
            },
            "{"
          ],
          "\n    ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"version\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " Number",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          " ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Versão do app"
          ],
          "\n    ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"communityInstallations\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " ",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "["
          ],
          "String",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "]"
          ],
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          " ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Provedores instalados que podem responser por essa ação"
          ],
          "\n    ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"action\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Action "
          ],
          "\n",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "}"
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "h2",
      {
        "id": "envio-de-uma-requisi-o-para-um-dos-provedores-de-uma-informa-o"
      },
      " ",
      [
        "a",
        {
          "href": "#envio-de-uma-requisi-o-para-um-dos-provedores-de-uma-informa-o"
        },
        "Envio de uma requisição para um dos provedores de uma informação"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Uma vez que o app sabe qual provedor irá usar, o app deve realizar uma requisição seguindo o formato especificado na documentação da action para a rota abaixo. Nesse exemplo, a requisição é para obter informações de calendário."
    ],
    " ",
    [
      "docs-code",
      {
        "language": "http"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token method"
            },
            [
              "span",
              {
                "class": "token post"
              },
              "POST"
            ]
          ],
          " ",
          [
            "span",
            {
              "class": "token path"
            },
            "/services/call/",
            [
              "span",
              {
                "class": "token param"
              },
              "{action}"
            ],
            "/",
            [
              "span",
              {
                "class": "token param"
              },
              "{provider}"
            ]
          ],
          [
            "span",
            {
              "class": "token query"
            },
            [
              "span",
              {
                "class": "token separator"
              },
              "?"
            ],
            [
              "span",
              {
                "class": "token param"
              },
              [
                "span",
                {
                  "class": "token name"
                },
                "version"
              ],
              "=",
              [
                "span",
                {
                  "class": "token value"
                },
                [
                  "span",
                  {
                    "class": "token string"
                  },
                  "{versao}"
                ]
              ]
            ],
            [
              "span",
              {
                "class": "token separator"
              },
              "&"
            ],
            [
              "span",
              {
                "class": "token param"
              },
              [
                "span",
                {
                  "class": "token name"
                },
                "_community"
              ],
              "=",
              [
                "span",
                {
                  "class": "token value"
                },
                [
                  "span",
                  {
                    "class": "token string"
                  },
                  "{idComunidade}"
                ]
              ]
            ]
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "docs-code",
      {
        "language": "js"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token punctuation"
            },
            "{"
          ],
          "\n  ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"context\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " ",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "{"
          ],
          "\n    ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"issuedAt\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " Date",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "  ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Quando a chamada foi feita"
          ],
          "\n    ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"action\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"@layers:Calendar:getRelated\""
          ],
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          " ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Identificador da action"
          ],
          "\n    ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"community\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "  ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Comunidade do usuário"
          ],
          "\n  ",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "}"
          ],
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "\n  ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"data\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " ",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "{"
          ],
          "\n    ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"user\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " ",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "{"
          ],
          "\n      ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"id\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "  ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// ID do usuário"
          ],
          "\n      ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"name\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "  ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Nome do usuário"
          ],
          "\n      ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"alias\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String ",
          [
            "span",
            {
              "class": "token operator"
            },
            "|"
          ],
          " Number ",
          [
            "span",
            {
              "class": "token operator"
            },
            "|"
          ],
          " ",
          [
            "span",
            {
              "class": "token keyword"
            },
            "null"
          ],
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "  ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Alias do usuário"
          ],
          "\n      ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"timezone\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "  ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Fuso horário do usuário"
          ],
          "\n      ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"language\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "  ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Língua preferencial do usuário"
          ],
          "\n      ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"accountId\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "  ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// ID da account do usuário"
          ],
          "\n    ",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "}"
          ],
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "\n  ",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "}"
          ],
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          "\n  ",
          [
            "span",
            {
              "class": "token string"
            },
            "\"secret\""
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            ":"
          ],
          " String",
          [
            "span",
            {
              "class": "token punctuation"
            },
            ","
          ],
          " ",
          [
            "span",
            {
              "class": "token comment"
            },
            "// Chave secreta"
          ],
          "\n",
          [
            "span",
            {
              "class": "token punctuation"
            },
            "}"
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Ao receber essa requisição, o Layers verifica não somente o corpo da requisição mas também  se o app tem permissão para requisitar a action especificada checando também se o provider especificado existe e está instalado na comunidade especificada. Apenas se a requisição passar nas validações ela será repassada para o provedor."
    ],
    " ",
    [
      "h2",
      {
        "id": "repasse-da-resposta-validada"
      },
      " ",
      [
        "a",
        {
          "href": "#repasse-da-resposta-validada"
        },
        "Repasse da resposta validada"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Ao receber a resposta do provedor, o Layers valida se ela está de acordo com o padrão de resposta esperado para essa action. Se a resposta for validada com sucesso ela é então repassada para o app que fez a requisição."
    ]
  ],
  "title": "Requisitando informações",
  "headings": [
    {
      "text": "Requisitos",
      "href": "#requisitos"
    },
    {
      "text": "Encontrar provedores para uma determinada action",
      "href": "#encontrar-provedores-para-uma-determinada-action"
    },
    {
      "text": "Envio de uma requisição para um dos provedores de uma informação",
      "href": "#envio-de-uma-requisi-o-para-um-dos-provedores-de-uma-informa-o"
    },
    {
      "text": "Repasse da resposta validada",
      "href": "#repasse-da-resposta-validada"
    }
  ],
  "pageClass": "page-guides-apihub-requisitando-informacoes"
}
