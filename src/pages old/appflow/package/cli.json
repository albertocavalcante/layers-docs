{
  "path": "/docs/appflow/package/cli",
  "previousText": "Native Configurations",
  "previousUrl": "/docs/appflow/package/native-configs",
  "nextText": "Automations",
  "nextUrl": "/docs/appflow/automation/intro",
  "body": [
    "div",
    null,
    [
      "blockquote",
      null,
      " ",
      [
        "p",
        null,
        [
          "b",
          null,
          "Note:"
        ],
        " This feature is only available on our ",
        [
          "b",
          null,
          "Scale"
        ],
        " plan. Please ",
        [
          "a",
          {
            "href": "/sales"
          },
          "contact us"
        ],
        " to enable this feature."
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "It is possible to trigger Package builds on Appflow directly from the CLI.\nThis is extremely useful if you need to integrate the Package build step as part of an existing external CI/CD process."
    ],
    " ",
    [
      "h3",
      {
        "id": "prerequisites"
      },
      " ",
      [
        "a",
        {
          "href": "#prerequisites"
        },
        "Prerequisites"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Upgrade the Ionic CLI to at least version ",
      [
        "code",
        null,
        "4.7.0"
      ],
      "."
    ],
    " ",
    [
      "p",
      null,
      "To trigger Package builds on Appflow from the Ionic CLI, a proper subscription to run Package builds is needed."
    ],
    " ",
    [
      "p",
      null,
      "To use Environments, a proper subscription that allows the usage of Automations is needed."
    ],
    " ",
    [
      "h3",
      {
        "id": "authentication"
      },
      " ",
      [
        "a",
        {
          "href": "#authentication"
        },
        "Authentication"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "The Ionic CLI has to be authenticated on Appflow to be able to trigger a Package build."
    ],
    " ",
    [
      "p",
      null,
      "To login type:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          "ionic login ",
          [
            "span",
            {
              "class": "token operator"
            },
            "<"
          ],
          "email",
          [
            "span",
            {
              "class": "token operator"
            },
            ">"
          ],
          " ",
          [
            "span",
            {
              "class": "token operator"
            },
            "<"
          ],
          "password",
          [
            "span",
            {
              "class": "token operator"
            },
            ">"
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "This will prompt for the Appflow username/password."
    ],
    " ",
    [
      "p",
      null,
      "The CLI can also be authenticated via an environment variable (for example, if it is used during a CI/CD task)."
    ],
    " ",
    [
      "p",
      null,
      "To set up the authentication via environment variable, first login via the CLI with an Appflow user who has access to the app you want to trigger Deploy builds for:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          "ionic login ",
          [
            "span",
            {
              "class": "token operator"
            },
            "<"
          ],
          "email",
          [
            "span",
            {
              "class": "token operator"
            },
            ">"
          ],
          " ",
          [
            "span",
            {
              "class": "token operator"
            },
            "<"
          ],
          "password",
          [
            "span",
            {
              "class": "token operator"
            },
            ">"
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Then, export the authentication token:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          "ionic config get -g tokens.user"
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Finally, export the token in an environment variable of your shell or your CI/CD service."
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          [
            "span",
            {
              "class": "token builtin class-name"
            },
            "export"
          ],
          " ",
          [
            "span",
            {
              "class": "token assign-left variable"
            },
            "IONIC_TOKEN"
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            "="
          ],
          [
            "span",
            {
              "class": "token operator"
            },
            "<"
          ],
          "your token",
          [
            "span",
            {
              "class": "token operator"
            },
            ">"
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "h3",
      {
        "id": "link-the-app"
      },
      " ",
      [
        "a",
        {
          "href": "#link-the-app"
        },
        "Link the app"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Your app must be linked to the remote app on Appflow. If the app is not linked yet, run:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          "ionic ",
          [
            "span",
            {
              "class": "token function"
            },
            "link"
          ],
          " ",
          [
            "span",
            {
              "class": "token operator"
            },
            "<"
          ],
          "app id",
          [
            "span",
            {
              "class": "token operator"
            },
            ">"
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "and commit the changes to ",
      [
        "code",
        null,
        "ionic.config.json"
      ],
      "."
    ],
    " ",
    [
      "h3",
      {
        "id": "trigger-a-package-build"
      },
      " ",
      [
        "a",
        {
          "href": "#trigger-a-package-build"
        },
        "Trigger a package build"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Currently, Package builds can only be triggered from the root project directory:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          [
            "span",
            {
              "class": "token builtin class-name"
            },
            "cd"
          ],
          " /path/to/your/app"
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Assuming the CLI is authenticated, to trigger a Package build, run:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          "ionic package build"
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "This will prompt for the desired platform (",
      [
        "code",
        null,
        "ios"
      ],
      "/",
      [
        "code",
        null,
        "android"
      ],
      ") and build type for the platform."
    ],
    " ",
    [
      "p",
      null,
      "For iOS or Android ",
      [
        "code",
        null,
        "release"
      ],
      " builds, a valid security profile is required and can be specified using the ",
      [
        "code",
        null,
        "--security-profile=<name>"
      ],
      " option."
    ],
    " ",
    [
      "p",
      null,
      "For information on setting up security profiles, see ",
      [
        "stencil-route-link",
        {
          "url": "/docs/appflow/package/credentials"
        },
        "here"
      ],
      "."
    ],
    " ",
    [
      "p",
      null,
      "The previous commands can be executed in a single step:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          "ionic package build ios development --security-profile",
          [
            "span",
            {
              "class": "token operator"
            },
            "="
          ],
          [
            "span",
            {
              "class": "token string"
            },
            "\"My Security Profile\""
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Once the build is successfully triggered, the CLI will automatically start tailing the logs from Appflow and, if the build is successful, download the ",
      [
        "code",
        null,
        "apk"
      ],
      "/",
      [
        "code",
        null,
        "ipa"
      ],
      " file in the current directory."
    ],
    " ",
    [
      "h3",
      {
        "id": "customize-the-package-build-with-options"
      },
      " ",
      [
        "a",
        {
          "href": "#customize-the-package-build-with-options"
        },
        "Customize the package build with Options"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "The Options available to customize the build include:"
    ],
    " ",
    [
      "ul",
      null,
      " ",
      [
        "li",
        null,
        [
          "code",
          null,
          "--environment=<name>"
        ],
        " to specify the group of environment variables to be exposed to the build\n(available only with Automation; more info about environments are available ",
        [
          "stencil-route-link",
          {
            "url": "/docs/appflow/environments/"
          },
          "here"
        ],
        ")"
      ],
      " ",
      [
        "li",
        null,
        [
          "code",
          null,
          "--native-config=<name>"
        ],
        " to specify the group of native config variables to be exposed to your\nbuild (more info about native configs are available ",
        [
          "stencil-route-link",
          {
            "url": "/docs/appflow/package/intro/#native-configs"
          },
          "here"
        ],
        ")"
      ],
      " "
    ],
    " ",
    [
      "h3",
      {
        "id": "customize-the-package-build-with-advanced-options"
      },
      " ",
      [
        "a",
        {
          "href": "#customize-the-package-build-with-advanced-options"
        },
        "Customize the package build with Advanced Options"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "The Advanced Options available to customize the build include:"
    ],
    " ",
    [
      "ul",
      null,
      " ",
      [
        "li",
        null,
        [
          "code",
          null,
          "--commit=<sha1>"
        ],
        " The commit defaults to HEAD; to use a different commit you can use this option\nwith the full SHA1 of the commit"
      ],
      " ",
      [
        "li",
        null,
        [
          "code",
          null,
          "--target-platform=<name>"
        ],
        " This option is mostly useful for iOS builds if for any reason a package build with a\nspecific version of Xcode is needed. If this is omitted the preferred version is used."
      ],
      " ",
      [
        "li",
        null,
        [
          "code",
          null,
          "--build-file-name=<name>"
        ],
        " To override the downloaded file name use this option. This might be useful, for instance, in in a CI\nbuild to have a consistent name for the produced artifact."
      ],
      " "
    ],
    " ",
    [
      "h3",
      {
        "id": "note-about-referencing-options-values-by-name"
      },
      " ",
      [
        "a",
        {
          "href": "#note-about-referencing-options-values-by-name"
        },
        "Note about referencing Options values by name"
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Names are case sensitive and need to be specified including spaces, for instance:"
    ],
    " ",
    [
      "docs-code",
      {
        "language": "shell"
      },
      " ",
      [
        "pre",
        null,
        [
          "code",
          null,
          [
            "span",
            {
              "class": "token prompt"
            },
            "$ "
          ],
          "ionic package build ios development --security-profile",
          [
            "span",
            {
              "class": "token operator"
            },
            "="
          ],
          [
            "span",
            {
              "class": "token string"
            },
            "\"iOS Dev\""
          ]
        ]
      ],
      " "
    ],
    " ",
    [
      "p",
      null,
      "Apart from the ",
      [
        "code",
        null,
        "--commit"
      ],
      " option, all others require the full name setup within the Appflow Dashboard."
    ],
    " ",
    [
      "p",
      null,
      "Look for the name on the Security Profiles, Environments and Native Configs pages in Appflow:"
    ],
    " ",
    [
      "p",
      null,
      [
        "img",
        {
          "src": "/docs/assets/img/appflow/cli-security-profile-list.png",
          "alt": "Security Profiles"
        }
      ],
      " ",
      [
        "img",
        {
          "src": "/docs/assets/img/appflow/cli-environments-list.png",
          "alt": "Environments"
        }
      ],
      " ",
      [
        "img",
        {
          "src": "/docs/assets/img/appflow/cli-native-config-list.png",
          "alt": "Native Configs"
        }
      ]
    ],
    " ",
    [
      "p",
      null,
      "For the Target Platform, use one of the strings identifying the platform in the Applflow Package Build form:"
    ],
    " ",
    [
      "p",
      null,
      [
        "img",
        {
          "src": "/docs/assets/img/appflow/cli-target-platform.png",
          "alt": "Target Platform"
        }
      ]
    ]
  ],
  "title": "Package builds on Appflow using the Ionic CLI",
  "headings": [],
  "pageClass": "page-appflow-package-cli"
}
